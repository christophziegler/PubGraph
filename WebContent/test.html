<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- jQuery -->
<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<!-- PubDB Parser -->
<script type="text/javascript" src="js/pubdb.js"></script>

<script type="text/javascript" src="js/author.js"></script>

<!-- D3 -->
<script src="http://d3js.org/d3.v3.min.js"></script>

<!-- jQuery UI -->
<link rel="stylesheet"
	href="http://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>

<script type="text/javascript" src="js/testobj.js"></script>

<script type="text/javascript">
	

	function createCoauthorsChart(parentNodeId, data) {

		var width = $(window).width()*.8, barHeight = 35;

		var x = d3.scale.linear().range([0, width*.8 ]);

		var chart = d3.select("#" + parentNodeId).append("svg")
				.attr("class", "chart").attr("id", "#coauthorsChart")
				.attr("width", width);

		x.domain([ 0, d3.max(data, function(d) {
			return d.numColab;
		}) ]);

		chart.attr("height", barHeight * data.length);

		var bar = chart.selectAll("g").data(data).enter().append("g").attr(
				"transform", function(d, i) {
					return "translate(" + width*.2 + "," + i * barHeight + ")";
				});

		bar.append("rect").attr("width", function(d) {
			return x(d.numColab);
		}).attr("height", barHeight - 1);

		bar.append("text").attr("x", function(d) {
			return x(d.numColab) - 3;
		}).attr("y", barHeight / 2).attr("dy", ".35em").text(function(d) {
			return d.numColab;
		}).attr("class", "num");
		
		bar.append("text").attr("x", function(d) {
			return -5;
		}).attr("y", barHeight / 2).attr("dy", ".35em").text(function(d) {
			return d.name;
		}).attr("class", "name")
		.on("click", function () {
			AuthorView.getInstance(author, pub).show(this.innerHTML);
		});
		
		function type(d) {
			d.numColab = +d.numColab;
			return d;
		}

	}
	
	$(function () {
		
		createCoauthorsChart("view", butz);
		
		$("#loadingContainer").fadeOut();
		
	});
</script>

<link href="css/details.css" type="text/css" rel="stylesheet"></link>

<title>Test</title>
</head>
<body>

	<div id="view"></div>
	
	<div id="author" class="dialog">
		<div class="details">
			<ul>
				<li><a href="#general">General</a></li>
				<li><a href="#publications">Publications</a></li>
				<li><a href="#coauthors">Coauthors</a></li>
				<li><a href="#activity">Activity</a></li>
			</ul>
			<div id="general"></div>
			<div id="publications" class="accordion"></div>
			<div id="coauthors" class="accordion"></div>
			<div id="activity"></div>
		</div>
	</div>

	<div id="loadingContainer">
		<div id="loadingJello">
			<img alt="Loading ..." src="img/loading.gif">
		</div>
	</div>
	
</body>
</html>